## X. تكافؤ بيئات التشغيل
### الحفاظ علي بيئات التطوير والانتاج وتجريب ما قبل الانتاج متشابهة قدر الإمكان

تاريخياً، كان هناك فجوات جوهرية بين بيئة التطوير (حيث يقوم المطور بإجراء تعديلات لحظية علي [الإطلاقة](./codebase) المحلية للتطبيق ) وبيئة الإنتاج (الإطلاقة قيد التشغيل والمستخدمة بواسطة المستخدمين النهائيين) هذه الفجوات تتلخص في ثلاث مساحات:

* **الفجوة الزمنية** : المطور قد يعمل علي كود بصورة تستغرق أيام أو أسابيع أو حتي شهور ليصل إلي الإنتاج
* **الفجوة الشخصية**: المطور يكتب الكود، ومهندس التشغيل هو من يقوم بإطلاقه.
* **فجوة الأدوات**: المطورين قد يستخدمون مجموعة أدوات مثل Nginx, SQLite, و OSX، بينما بيئة الإنتاج تستخدم أدوات أخرى مثل Apache, MySQL, و Linux.

**تطبيق القواعد الإثني عشر مصمم بهدف [الإطلاق المستمر](http://avc.com/2011/02/continuous-deployment/) من خلال تقليص الفجوة بين بيئتي التطوير والإنتاج** بالنظر للثلاث فجوات سالفة الذكر:

* يقلص الفجوة الزمنية: المطور قد يكتب الكود ثم يقوم بإطلاقه بعد ساعات أو حتي دقائق.
* يقلص الفجوة الشخصية: المطورين الذين يكتبون الكود يساهمون عن قرب في إطلاقه ويراقبون أداءه علي بيئة الإنتاج
* يقلص فجوة الأدوات: يُبقي علي بيئتي التطوير والإنتاج متشابهتين قدر الإمكان.

تلخيص لما سبق في جدول:


<table>
  <tr>
    <th></th>
    <th>تطبيق تقليدي</th>
    <th>تطبيق القواعد ال١٢</th>
  </tr>
  <tr>
    <th>الوقت بين الإطلاقات</th>
    <td>أسابيع</td>
    <td>ساعات</td>
  </tr>
  <tr>
    <th>كاتبي الكود مقابل مطلقي الكود</th>
    <td>أشخاص مختلفين</td>
    <td>نفس الأشخاص</td>
  </tr>
  <tr>
    <th>بيئة التطوير مقابل الإنتاج</th>
    <td>متباينتين</td>
    <td>متشابهتين قدر الإمكان</td>
  </tr>
</table>

[الخدمات الداعمة](./backing-services)، مثل قاعدة بيانات التطبيق، نظام صف انتظار المهام، أو الكاش، هم مساحة واحدة حيث التكافؤ مهم بين التطوير والإنتاج. لغات متعددة تقدم مكتبات تستهدف تسهيل الوصول إلى الخدمات الداعمة، شاملةً محولات لأنواع مختلفة من الخدمات. بعض أمثلتها في الجدول التالي:
 

<table>
  <tr>
    <th>النوع</th>
    <th>اللغة</th>
    <th>المكتبة</th>
    <th>المحولات</th>
  </tr>
  <tr>
    <td>قاعدة بيانات</td>
    <td>Ruby/Rails</td>
    <td>ActiveRecord</td>
    <td>MySQL, PostgreSQL, SQLite</td>
  </tr>
  <tr>
    <td>صف انتظار</td>
    <td>Python/Django</td>
    <td>Celery</td>
    <td>RabbitMQ, Beanstalkd, Redis</td>
  </tr>
  <tr>
    <td>كاش</td>
    <td>Ruby/Rails</td>
    <td>ActiveSupport::Cache</td>
    <td>Memory, filesystem, Memcached</td>
  </tr>
</table>

يجد المطورون أحياناً رغبة ملحة في استخدام خدمات داعمة خفيفة علي بيئتهم الشخصية، بينما تكون الخدمات الداعمة الجادة والقوية مستخدمة في الإنتاج. علي سبيل المثال، استخدام SQLite محلياً و PostgreSQL في الإنتاج، أو ذاكرة عمليات محلية للكاش في التطوير و Memcashed في الإنتاج.

**المطور المُتبع للقواعد الإثني عشر يقاوم الحاجة إلي استخدام خدمات داعمة مختلفة بين التطوير والإنتاج**، حتي لو أن المحولات تزيل -نظرياً- أي فوارق بين الخدمات الداعمة. الفروق بين الخدمات الداعمة يعني أن بعضاً من عدم التوافقية سوف تحدث، متسببة في وجود كود يعمل وينجح في الاختبار علي بيئة التطوير أو تجريب ما قبل الإنتاج، ثم يفشل عند الإنتاج. هذا النوع من الأخطاء يخلق خلافاً يثبط الحافز للإطلاق المستمر. تكلفة هذا الخلاف وما يلحقة من تخاذل في الإطلاق المستمر هي عالية جداً إذا نظرنا للتراكم بعين الاعتبار خلال دورة حياة التطبيق.

الخدمات المحلية الخفيفة ليست قهرية عما كانت عليه من قبل، الخدمات الداعمة الحديثة مثل Memcached, PostgreSQL, و RabbitMQ ليست صعبة التثبيت او التشغيل بفضل نظم التحزيم الحديثة مثل [Homebrew](http://mxcl.github.com/homebrew/) و [apt-get](https://help.ubuntu.com/community/AptGet/Howto). بشكل بديل، أدوات التهيئة التصريحية مثل [Chef](http://www.opscode.com/chef/) و [Puppet](http://docs.puppetlabs.com/) بالاشتراك مع البيئات الافتراضية مثل [Docker](https://www.docker.com/) و [Vagrant](http://vagrantup.com/) تسمح للمطورين بتشغيل بيئة محلية مطابقة تقريباً لبيئة الإنتاج. تكلفة تثبيت واستخدام هذه الآنظمة منخفض مقارنة بفائدة تكافؤ التطوير/الانتاج والإطلاق المستمر.

المحولات للخدمات الداعمة المختلفة مازالت مفيدة، لأنها تجعل الإنتقال إلي خدمات داعمة جديدة غير مؤلم نسبياً. لكن كل إطلاقات التطبيق (بيئة المطور، تجريب ما قبل الإنتاجو وبيئة الإنتاج) يجب أن تستخدم نفس النوع والإصدار لكل الخدمات الداعمة.
