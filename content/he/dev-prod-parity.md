## X. דמיון בין סביבת הפיתוח לסביבת הפרודקשיין
### שמור את סביבות הפיתוח, בדיקות ופרודקשיין דומות ככל האפשר

מבחינה היסטורית, ישנם הבדלים בין סביבת הפיתוח (מפתח מבצע שינויים ב[פריסה](./codebase) מקומית של האפליקציה) לבין סביבת הפרודקשיין (היכן שמשתמשי הקצה משתמשים באפלקיציה). הבדלים אלו באים לידי ביטוי בשלושה אזורים:

* **פער הזמן**: ייתכן ומפתח יעבוד על קוד שייקח ימים, שבועות או אפילו חודשים עד שיירד לפרודקשיין.
* **פער העובדים**: מפתחים כותבים קוד, מהנדסי תפעול פורסים אותו.
* **פער הכלים**: ייתכן והמפתחים משתמשים ב-Nginx, SQLite וב-OS X, בעוד שבסביבת הפרודקשיין יש Apache, MySQL ולינוקס.

**אפליקצייה שעובדת על פי עקרונות שניים-עשר הגורמים מתוכננת ל-[פריסה עוקבת (continuous deployment)](http://avc.com/2011/02/continuous-deployment/) על ידי כך שהיא שומרת על הבדלים קטנים ככל שניתן בין הסביבות.** בהסתכלות על שלושת הפערים שציינו:

* שמור על פער זמן קצר ככל שניתן: ייתכן שמפתח יכתוב קוד ויפרוס אותו לאחר שעות או אפילו דקות.
* שמור על פער עובדים קטן: מפתחים אשר כותבים קוד והם מעורבים בתהליך הפריסה של האפליקציה לסביבת הפרודקשיין.
* שמור על פער כלים קטן: השתמש באותם הכלים בין הסביבות ככל שאפשר.

ניתן לתמצת הכל לטבלה:

<table>
  <tr>
    <th></th>
    <th>אפליקצייה רגילה</th>
    <th>אפליקציה על פי שניים-עשר הגורמים</th>
  </tr>
  <tr>
    <th>זמן בין פריסות</th>
    <td>שבועות</td>
    <td>שעות</td>
  </tr>
  <tr>
    <th>מפתחים מול פורסים</th>
    <td>אנשים שונים</td>
    <td>אותם האנשים</td>
  </tr>
  <tr>
    <th>סיבות פיתוח מול סביבות פרודקשיין</th>
    <td>שונות</td>
    <td>דומות ככל שניתן</td>
  </tr>
</table>

[שירותים מגבים](./backing-services), כמו בסיס הנתונים, שירותי תורים או זכרון מטמון הוא אזור שבו הדמיון חשוב מאוד. שפות רבות מציעות ספריות אשר מקלות על הגישה לשירות ואף *מתאמים* לסוגים שונים של שירותים. כמה דוגמאות בטבלה מטה.

<table>
  <tr>
    <th>סוג</th>
    <th>שפה</th>
    <th>ספריה</th>
    <th>מתאם</th>
  </tr>
  <tr>
    <td>בסיס נתונים</td>
    <td>Ruby/Rails</td>
    <td>ActiveRecord</td>
    <td>MySQL, PostgreSQL, SQLite</td>
  </tr>
  <tr>
    <td>תור</td>
    <td>Python/Django</td>
    <td>Celery</td>
    <td>RabbitMQ, Beanstalkd, Redis</td>
  </tr>
  <tr>
    <td>זכרון מטמון</td>
    <td>Ruby/Rails</td>
    <td>ActiveSupport::Cache</td>
    <td>Memory, filesystem, Memcached</td>
  </tr>
</table>

לעיתים מפתחים משתמשים בשירותים "קלים" יותר בסביבת הפיתוח ובשירותים מלאים יותר בסביבת הפרודקשיין. לדוגמא, SQLite עבור הסביבה המקומית ו-PostgreSQL עבור סביבת הפרודקשיין; או זכרון מקומי עבור זכרון מטמון בזמן פיתוח ו-Memcached בסביבת הפרודקשיין.

**מפתחים אשר עובדים על פי מתודולוגיית שניים-עשר הגורמים עומדים בדחף להשתמשים בשירותים שונים בין סביבות שונות**, אפילו כאשר מתאמים גמפשטים את השינויים. כאשר ישנם שינויים בין השירותים, אפילו ההבדל הקטן ביותר יכול לגרום לקוד שעובד ועובר בדיקות, לא לעבוד בפרודקשיין. שגיאות כאלו גורמות לחיכוכים אשר מוציאות את הרוח ממפרשי פריסה מתמשכת. המחיר של החיכוך הזה ומחסור בפריסה מתמשכת הוא גבוה לאין שעור ככל שהאפליקציה גדלה והזמן עובר.

שירותים "קלים" כבר אינם מושכים כמו פעם. שירותים מודרניים כמו Memcached, PostgreSQL ו-RabbitMQ אינם קשים להתקנה והרצה על ידי שימוש במנהלי חבילות כמו [Homebrew](http://mxcl.github.com/homebrew/) ו-[apt-get](https://help.ubuntu.com/community/AptGet/Howto). לחלופין, כלים כמו [Chef](http://www.opscode.com/chef/) ו-[Puppet](http://docs.puppetlabs.com/) ביחד עם סביבות וירטואליות "קלות" כמו [Docker](https://www.docker.com/) ו-[Vagrant](http://vagrantup.com/), מאפשרים למפתחים להריץ סביבה מקומית דומה ככל האפשר לסביבת הפרודקיין. המחיר של התקנת כלים אלו הוא נמוך מאוד בהשוואה לרווח מדמיון בין הסביבות ואפשרות לביצוע פריסה מתמשכת.

מתאמים לשירותים שונים עדיין יעילים, שכן הם מאפשרים מעבר לשירות אחר כמעט בלי כאב. אבל על הפריסות של האפליקציה (בסביבות הפיתוח, בדיקות ופרודקשיין) צריכות להשתמש באותה גרסה של השירות.