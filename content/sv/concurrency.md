## VIII. Concurrency (Samtidighet)
### Skala ut systemet inom process modellen

Alla datorprogram, medan det körs, representeras av en eller flera processer. Webbapplikationer har tagit en mångfald av former för process-exekvering. Till exempel, PHP-processer körs som ärvda processer till Apache, som startas utifrån behov av den efterfrågande processen. Java-processer tar det motsatta tillvägagångssättet, med en JVM som bistår med en massiv överprocess som reserverar stora mängder av systemresurser (CPU och minne) vid uppstart, med hantering av samtidiga processer via trådar. I båda fallen är de exekverade processerna endast minimalt synliga för applikationsutvecklarna.

Any computer program, once run, is represented by one or more processes.  Web apps have taken a variety of process-execution forms.  For example, PHP processes run as child processes of Apache, started on demand as needed by request volume.  Java processes take the opposite approach, with the JVM providing one massive uberprocess that reserves a large block of system resources (CPU and memory) on startup, with concurrency managed internally via threads.  In both cases, the running process(es) are only minimally visible to the developers of the app.

![Skalbarhet är uttryckt genom exekverade processer, mångfald gällande arbetsbelastning uttrycks som processtyper.](/images/process-types.png)
![Scale is expressed as running processes, workload diversity is expressed as process types.](/images/process-types.png)

**I tolvfaktor-applikationen är processer i första rummet.** Processer i en tolvfaktor-applikation tar i huvudsak styrning från [unix-processmodell för att köra tjänst-daemoner](https://adam.herokuapp.com/past/2011/5/9/applying_the_unix_process_model_to_web_apps/). När man använder denna modell kan utvecklarna designa sin applikation till att hantera olika arbetsbelastningar genom att tilldela varje typ av arbete till en *processtyp*. Till exempel, HTTP-anrop kan hanteras av en webbprocess, och mer långkörande bakgrundsuppgifter hanteras av en arbetsprocess.
**In the twelve-factor app, processes are a first class citizen.**  Processes in the twelve-factor app take strong cues from [the unix process model for running service daemons](https://adam.herokuapp.com/past/2011/5/9/applying_the_unix_process_model_to_web_apps/).  Using this model, the developer can architect their app to handle diverse workloads by assigning each type of work to a *process type*.  For example, HTTP requests may be handled by a web process, and long-running background tasks handled by a worker process.

Detta utesluter inte att individuella processer hanterar deras egen interna arbetsfördelning, via trådar inuti den egna virtuella maskinen, eller via en asynkron-/händelse-modell som man hittar ex. i verktyg som [EventMachine](https://github.com/eventmachine/eventmachine), [Twisted](http://twistedmatrix.com/trac/), eller [Node.js](http://nodejs.org/). Men enskilda virtuella maskiner kan bara växa upp till en viss nivå, så applikationen måste dessutom ha möjlighet att fördela sig över multipla processer som körs på multipla fysiska maskiner.
This does not exclude individual processes from handling their own internal multiplexing, via threads inside the runtime VM, or the async/evented model found in tools such as [EventMachine](https://github.com/eventmachine/eventmachine), [Twisted](http://twistedmatrix.com/trac/), or [Node.js](http://nodejs.org/).  But an individual VM can only grow so large (vertical scale), so the application must also be able to span multiple processes running on multiple physical machines.

Processmodellen kommer verkligen till sin rätt när det gäller att skala upp. Modellens natur innebär att [man inte delar resurser, horisontellt partionerar processer](./processes) vilket betyder att lägga till mer samtidighet är en enkel och pålitlig handling. Samlingen av processtyper och antalet processer av respektive typ är vad som kallas för *processformering*.
The process model truly shines when it comes time to scale out.  The [share-nothing, horizontally partitionable nature of twelve-factor app processes](./processes) means that adding more concurrency is a simple and reliable operation.  The array of process types and number of processes of each type is known as the *process formation*.

Tolvfaktor-processer [bör aldrig daemonisera](http://dustin.github.com/2010/02/28/running-processes.html) eller skriva PID-filer. Istället bör man lita på systemets egen processhanterare (som exempelvis [systemd](https://www.freedesktop.org/wiki/Software/systemd/)), en distribuerad processhanterare på en molnplattform, eller ett verktyg som [Foreman](http://blog.daviddollar.org/2011/05/06/introducing-foreman.html) under utveckling) för att hantera [utströmmar](./logs), att ansvara för kraschade processer och att hantera omstarter och avstängningar initierade av användare.
Twelve-factor app processes [should never daemonize](http://dustin.github.com/2010/02/28/running-processes.html) or write PID files.  Instead, rely on the operating system's process manager (such as [systemd](https://www.freedesktop.org/wiki/Software/systemd/), a distributed process manager on a cloud platform, or a tool like [Foreman](http://blog.daviddollar.org/2011/05/06/introducing-foreman.html) in development) to manage [output streams](./logs), respond to crashed processes, and handle user-initiated restarts and shutdowns.
